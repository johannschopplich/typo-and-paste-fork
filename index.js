(function(){"use strict";const e=window.Vue;function k(){return window.panel}const T=()=>window.panel.plugins.viewButtons!==void 0,S=e.computed;e.customRef,e.defineAsyncComponent,e.defineComponent,e.effectScope,e.getCurrentInstance;const B=e.getCurrentScope;e.h,e.inject,e.isProxy,e.isReactive,e.isReadonly,e.isRef,e.isShallow,e.markRaw;const A=e.nextTick;e.onActivated,e.onBeforeMount,e.onBeforeUnmount,e.onBeforeUpdate,e.onDeactivated,e.onErrorCaptured;const I=e.onMounted;e.onRenderTracked,e.onRenderTriggered;const P=e.onScopeDispose;e.onServerPrefetch,e.onUnmounted,e.onUpdated,e.provide,e.proxyRefs,e.reactive,e.readonly;const w=e.ref;e.shallowReactive,e.shallowReadonly,e.shallowRef,e.toRaw,e.toRef,e.toRefs,e.triggerRef;const E=e.unref;e.useAttrs,e.useCssModule,e.useCssVars,e.useListeners,e.useSlots;const M=e.watch;e.watchEffect,e.watchPostEffect,e.watchSyncEffect;let v;async function R(){if(v)return v;try{v=await window.panel.api.get("typo-and-paste/characters")}catch(r){console.error("Error loading characters:",r),v=[]}return v}function V(r){return Object.prototype.toString.call(r)==="[object Object]"}function x(r,t,o,n,s,l,i,_){var d=typeof r=="function"?r.options:r;return t&&(d.render=t,d.staticRenderFns=o,d._compiled=!0),l&&(d._scopeId="data-v-"+l),{exports:r,options:d}}const L={__name:"CharacterSelector",props:{characters:{type:Array,required:!0},languageCode:{type:String,required:!0},type:{type:String,default:"dropdown"}},emits:["close"],setup(r,{emit:t}){const o=r,n=k(),s=w(),l=w(),i=o.type==="dialog"?12:8,_=S(()=>o.characters.map(a=>{let c;return V(a.label)?c=a.label[n.user.language]||a.label.en:c=a.label,{...a,label:c}}));I(async()=>{var a,c,f;await A(),(f=(c=(a=l.value)==null?void 0:a[0])==null?void 0:c.$el)==null||f.focus()});function d(a){navigator.clipboard.writeText(a),o.type==="dialog"?n.dialog.close():t("close"),n.notification.info({message:n.t("philippoehrlein.typo-and-paste.copiedMessage",{character:a}),icon:void 0})}function h(a){a.key!=="Enter"&&a.stopPropagation();const c=s.value,f=document.activeElement.closest(".tap-characters__section");if(!f)return;const g=[...f.querySelectorAll(".tap-characters__item")],m=g.indexOf(document.activeElement),b=c.indexOf(f);if(m===-1&&b===-1)return;let u,p;switch(a.key){case"ArrowRight":a.preventDefault(),u=m+1,u<g.length&&g[u].focus();break;case"ArrowLeft":a.preventDefault(),u=m-1,u>=0&&g[u].focus();break;case"ArrowDown":a.preventDefault(),u=m+i,u>=g.length?(p=b+1,p<c.length&&C(c[p])):g[u].focus();break;case"ArrowUp":a.preventDefault(),u=m-i,u<0?(p=b-1,p>=0&&y(c[p])):g[u].focus();break;case"Enter":case"Space":if(a.preventDefault(),m!==-1){const ne=g[m].textContent.trim();d(ne)}break;case"Tab":a.preventDefault(),a.shiftKey?(p=b-1,p<0?y(c.at(-1)):y(c[p])):(p=b+1,p>=c.length?C(c[0]):C(c[p]));break;case"Escape":t("close");break}}function C(a){var c;(c=a.querySelector(".tap-characters__item"))==null||c.focus()}function y(a){var f;(f=[...a.querySelectorAll(".tap-characters__item")].at(-1))==null||f.focus()}return{__sfc:!0,props:o,emit:t,panel:n,charactersSections:s,characterButtons:l,GRID_COLUMNS:i,resolvedCharacters:_,copyToClipboard:d,handleKeyNavigation:h,focusFirstButtonInSection:C,focusLastButtonInSection:y}}};var O=function(){var t=this,o=t._self._c,n=t._self._setupProxy;return t.characters.length?o("div",{staticClass:"tap-characters",class:[t.type!=="dialog"&&"tap-characters--dropdown"],attrs:{tabindex:"-1"}},[t._l(n.resolvedCharacters,function(s,l){return[!s.lang||s.lang===t.languageCode?o("section",{key:l,ref:"charactersSections",refInFor:!0,staticClass:"tap-characters__section"},[s.label?o("h3",[t._v(" "+t._s(s.label)+" ")]):t._e(),o("div",{staticClass:"tap-characters__items",style:{"--grid-columns":n.GRID_COLUMNS},on:{keydown:n.handleKeyNavigation}},t._l(s.characters,function(i){return o("k-button",{key:i,ref:"characterButtons",refInFor:!0,staticClass:"tap-characters__item",attrs:{tabindex:"0"},on:{click:function(_){return n.copyToClipboard(i)}}},[t._v(" "+t._s(i)+" ")])}),1)]):t._e()]})],2):t._e()},U=[],j=x(L,O,U,!1,null,"de39fc4c");const $=j.exports,F={__name:"DropdownButton",setup(r){const t=k(),o=w(),n=w([]),s=S(()=>{var i,_;return((i=t.language)==null?void 0:i.code)||((_=t.user)==null?void 0:_.language)||"en"});(async()=>n.value=await R())();function l(){o.value.toggle()}return{__sfc:!0,panel:t,dropdownContent:o,characters:n,languageCode:s,toggle:l,CharacterSelector:$}}};var K=function(){var t=this,o=t._self._c,n=t._self._setupProxy;return o("div",[o("k-button",{attrs:{dropdown:!0,title:n.panel.t("philippoehrlein.typo-and-paste.buttonTitle"),variant:"filled",size:"sm",icon:"typo-and-paste"},on:{click:function(s){return n.toggle()}}}),o("k-dropdown-content",{ref:"dropdownContent",attrs:{"align-x":"end"}},[o(n.CharacterSelector,{attrs:{characters:n.characters,"language-code":n.languageCode},on:{close:function(s){return n.toggle()}}})],1)],1)},q=[],H=x(F,K,q,!1,null,null);const D=H.exports,N={__name:"TypoAndPasteDialog",emits:["cancel","close","input","submit","success"],setup(r,{emit:t}){const o=k(),n=w([]),s=S(()=>{var l,i;return((l=o.language)==null?void 0:l.code)||((i=o.user)==null?void 0:i.language)||"en"});return(async()=>n.value=await R())(),{__sfc:!0,emit:t,panel:o,characters:n,languageCode:s,CharacterSelector:$}}};var z=function(){var t=this,o=t._self._c,n=t._self._setupProxy;return o("k-dialog",{staticClass:"k-typo-and-paste-dialog",attrs:{"cancel-button":!1,"submit-button":!1,visible:!0,size:"medium"},on:{cancel:function(s){return n.emit("cancel")}}},[o(n.CharacterSelector,{attrs:{characters:n.characters,"language-code":n.languageCode,type:"dialog"}})],1)},G=[],W=x(N,z,G,!1,null,null);const Z=W.exports;function J(r,t,o,n){let s;const l=()=>{s==null||s(),s=void 0},i=(h,C,y,a)=>(h.addEventListener(C,y,a),()=>h.removeEventListener(C,y,a)),_=M(()=>Q(r),h=>{l(),h&&(s=i(h,t,o,n))},{immediate:!0,flush:"post"}),d=()=>{_(),l()};return B()&&P(d),d}function Q(r){const t=E(r);return(t==null?void 0:t.$el)??t}const X={"typo-and-paste":'<path d="M10.931 22C9.57512 22 8.37089 21.7948 7.31831 21.3845C6.28357 20.9563 5.47183 20.3498 4.8831 19.5648C4.29437 18.7798 4 17.8432 4 16.7549C4 15.5239 4.31221 14.5427 4.93662 13.8113C5.56103 13.062 6.33709 12.5446 7.26479 12.2592V12.1521C6.46197 11.7596 5.78404 11.2512 5.23099 10.6268C4.69577 9.98451 4.42817 9.11925 4.42817 8.03098C4.42817 6.94272 4.70469 6.02394 5.25775 5.27465C5.82864 4.52535 6.62254 3.96338 7.63944 3.58873C8.65634 3.19624 9.84272 3 11.1986 3C12.5188 3 13.6784 3.20516 14.6775 3.61549C15.6944 4.02582 16.4883 4.61455 17.0592 5.38169C17.63 6.13099 17.9155 7.01408 17.9155 8.03098V8.48591H15.5606V8.19155C15.5427 7.46009 15.3376 6.86244 14.9451 6.39859C14.5704 5.9169 14.0531 5.56901 13.393 5.35493C12.7507 5.123 12.0014 5.00704 11.1451 5.00704C10.5742 5.00704 10.03 5.06948 9.51268 5.19437C8.99531 5.30141 8.53146 5.47981 8.12113 5.72958C7.72864 5.97934 7.41643 6.30939 7.18451 6.71972C6.95258 7.11221 6.83662 7.5939 6.83662 8.16479C6.83662 8.89624 7.01502 9.50282 7.37183 9.98451C7.72864 10.4484 8.19249 10.7962 8.76338 11.0282C9.35211 11.2601 9.98545 11.3761 10.6634 11.3761H12.3225V13.3296H10.7169C10.0033 13.3296 9.31643 13.4188 8.65634 13.5972C7.99624 13.7756 7.46103 14.1056 7.0507 14.5873C6.65822 15.0512 6.46197 15.7202 6.46197 16.5944C6.46197 17.3972 6.6493 18.0484 7.02394 18.5479C7.41643 19.0474 7.96056 19.4131 8.65634 19.6451C9.36995 19.877 10.1906 19.993 11.1183 19.993C12.1174 19.993 12.9469 19.8681 13.607 19.6183C14.2671 19.3685 14.7577 18.985 15.0789 18.4676C15.4 17.9502 15.5606 17.3169 15.5606 16.5676V11.3761H20.1901V13.3563H17.9155V16.4873C17.9155 17.6648 17.6479 18.6639 17.1127 19.4845C16.5953 20.3052 15.8192 20.9296 14.7845 21.3577C13.7498 21.7859 12.4653 22 10.931 22Z" />'},Y={"typo-and-paste":{icon:"typo-and-paste",label:"Typo & Paste",click(){window.panel.dialog.open({component:"k-typo-and-paste-dialog"})}}},ee={"typo-and-paste":{get button(){return{icon:"typo-and-paste",label:"Typo & Paste"}},commands(){return()=>{window.panel.dialog.open({component:"k-typo-and-paste-dialog"})}},get name(){return"typo-and-paste"}}};function te(r){if(T())return;let t;r.mixin({mounted(){if(this.$options.name!=="k-header")return;const o=this.$children.find(s=>s.$options.name==="k-button-group");if(!o)return;const n=r.extend(D);t=new n({parent:this}),t.$mount(),o.$el.prepend(t.$el)},beforeDestroy(){this.$options.name==="k-header"&&t&&(t.$destroy(),t=void 0)}})}window.panel.plugin("philippoehrlein/typo-and-paste",{icons:X,components:{"k-typo-and-paste-dialog":Z},viewButtons:{"typo-and-paste":D},textareaButtons:Y,writerMarks:ee,use:[function(){J(window,"keydown",r=>{!r.altKey||r.code!=="KeyT"||window.panel.dialog.open({component:"k-typo-and-paste-dialog"})})},te]})})();
