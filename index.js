(function(){"use strict";const e=window.Vue;function v(){return window.panel}const k=e.computed;e.customRef,e.defineAsyncComponent,e.defineComponent,e.effectScope,e.getCurrentInstance;const D=e.getCurrentScope;e.h,e.inject,e.isProxy,e.isReactive,e.isReadonly,e.isRef,e.isShallow,e.markRaw,e.nextTick,e.onActivated,e.onBeforeMount,e.onBeforeUnmount,e.onBeforeUpdate,e.onDeactivated,e.onErrorCaptured;const R=e.onMounted;e.onRenderTracked,e.onRenderTriggered;const T=e.onScopeDispose;e.onServerPrefetch,e.onUnmounted,e.onUpdated,e.provide,e.proxyRefs,e.reactive,e.readonly;const w=e.ref;e.shallowReactive,e.shallowReadonly,e.shallowRef,e.toRaw,e.toRef,e.toRefs,e.triggerRef;const A=e.unref;e.useAttrs,e.useCssModule,e.useCssVars,e.useListeners,e.useSlots;const B=e.watch;e.watchEffect,e.watchPostEffect,e.watchSyncEffect;function E(o){return Object.prototype.toString.call(o)==="[object Object]"}function b(o,t,a,r,c,l,g,u){var i=typeof o=="function"?o.options:o;return t&&(i.render=t,i.staticRenderFns=a,i._compiled=!0),l&&(i._scopeId="data-v-"+l),{exports:o,options:i}}const I={__name:"CharacterSelector",props:{characters:{type:Array,required:!0},languageCode:{type:String,required:!0},type:{type:String,required:!0,default:"dropdown"}},emits:["close"],setup(o,{emit:t}){const a=o,r=v(),c=k(()=>a.characters.map(n=>{let s;return E(n.label)?s=n.label[r.user.language]||n.label.en:s=n.label,m(),{...n,label:s}}));function l(n){navigator.clipboard.writeText(n),a.type==="dialog"?r.dialog.close():t("close"),r.notification.info({message:r.t("philippoehrlein.typo-and-paste.copiedMessage",{character:n}),icon:void 0})}const g=a.type==="dialog"?12:8;function u(n){n.key!=="Enter"&&n.stopPropagation();const s=Array.from(document.querySelectorAll(".tap-characters__section")),f=Array.from(n.currentTarget.querySelectorAll(".tap-characters__item")),h=f.findIndex(C=>C===document.activeElement),y=s.findIndex(C=>C.contains(document.activeElement));if(h===-1&&y===-1)return;let d,p;switch(n.key){case"ArrowRight":d=h+1,d<f.length&&f[d].focus(),n.preventDefault();break;case"ArrowLeft":d=h-1,d>=0&&f[d].focus(),n.preventDefault();break;case"ArrowDown":if(d=h+g,d>=f.length){if(p=y+1,p<s.length){i(s[p]),n.preventDefault();return}}else f[d].focus();n.preventDefault();break;case"ArrowUp":if(d=h-g,d<0){if(p=y-1,p>=0){_(s[p]),n.preventDefault();return}}else f[d].focus();n.preventDefault();break;case"Enter":case" ":if(n.preventDefault(),h!==-1){const C=f[h].textContent.trim();l(C)}break;case"Tab":n.preventDefault(),n.shiftKey?(p=y-1,p>=0&&i(s[p])):(p=y+1,p<s.length&&i(s[p]));break;case"Escape":t("close");break}}function i(n){const s=n.querySelector(".tap-characters__item");s&&s.focus()}function _(n){const s=Array.from(n.querySelectorAll(".tap-characters__item")),f=s[s.length-1];f&&f.focus()}function m(){setTimeout(()=>{const n=document.querySelector(".tap-characters__item");n&&n.focus()},0)}return R(()=>{m()}),{__sfc:!0,props:a,emit:t,panel:r,resolvedCharacters:c,copyToClipboard:l,GRID_COLUMNS:g,handleKeyNavigation:u,focusFirstButtonInSection:i,focusLastButtonInSection:_,focusFirstButton:m}}};var M=function(){var c;var t=this,a=t._self._c,r=t._self._setupProxy;return(c=t.characters)!=null&&c.length?a("div",{staticClass:"tap-characters",class:{"tap-characters--dialog":t.type==="dialog"},attrs:{tabindex:"-1"}},[t._l(r.resolvedCharacters,function(l,g){return[!l.lang||l.lang===t.languageCode?a("section",{key:g,staticClass:"tap-characters__section"},[l.label?a("h3",[t._v(" "+t._s(l.label)+" ")]):t._e(),a("div",{staticClass:"tap-characters__items",on:{keydown:r.handleKeyNavigation}},t._l(l.characters,function(u){return a("k-button",{key:u,staticClass:"tap-characters__item",attrs:{tabindex:"0"},on:{click:function(i){return r.copyToClipboard(u)}}},[t._v(" "+t._s(u)+" ")])}),1)]):t._e()]})],2):t._e()},P=[],V=b(I,M,P,!1,null,"0668ad33");const $=V.exports,q={__name:"DropdownButton",setup(o){const t=v(),a=w(),r=w(),c=w([]),l=k(()=>{var u,i;return((u=t.language)==null?void 0:u.code)||((i=t.user)==null?void 0:i.language)||"en"});return(async()=>{try{c.value=await t.api.get("typo-and-paste/characters")}catch(u){console.error("Error loading characters:",u)}})(),{__sfc:!0,panel:t,dropdownTrigger:a,dropdownContent:r,characters:c,languageCode:l,closeDropdown:()=>{r.value.toggle()},DropdownContent:$}}};var L=function(){var t=this,a=t._self._c,r=t._self._setupProxy;return a("div",[a("k-button",{ref:"dropdownTrigger",attrs:{dropdown:!0,title:r.panel.t("philippoehrlein.typo-and-paste.buttonTitle"),variant:"filled",size:"sm",icon:"typo-and-paste"},on:{click:function(c){return r.dropdownContent.toggle()}}}),a("k-dropdown-content",{ref:"dropdownContent",attrs:{"align-x":"end"}},[a(r.DropdownContent,{attrs:{characters:r.characters,"language-code":r.languageCode},on:{close:r.closeDropdown}})],1)],1)},U=[],j=b(q,L,U,!1,null,null);const S=j.exports,K={components:{DropdownContent:$},props:{visible:{default:!1,type:Boolean}},emits:["cancel","close","input","submit","success"],data(){return{dropdownContent:void 0,characters:[]}},computed:{languageCode(){var o,t;return((o=this.$panel.language)==null?void 0:o.code)||((t=this.$panel.user)==null?void 0:t.language)||"en"}},async created(){try{this.characters=await this.$panel.api.get("typo-and-paste/characters")}catch(o){console.error("Error loading characters:",o)}},methods:{cancel(){this.$emit("cancel")},close(){this.$emit("close")},open(){this.$panel.dialog.open(this)},submit(){this.$emit("submit",this.value)},success(o){this.$emit("success",o)}}};var F=function(){var t=this,a=t._self._c;return a("k-dialog",{staticClass:"k-typo-and-paste-dialog",attrs:{"cancel-button":!1,"submit-button":!1,size:"medium",visible:t.visible},on:{cancel:function(r){return t.$emit("cancel")}}},[a("DropdownContent",{attrs:{characters:t.characters,"language-code":t.languageCode,type:"dialog"}})],1)},H=[],O=b(K,F,H,!1,null,null);const z=O.exports;function N(o,t,a,r){let c;const l=()=>{c==null||c(),c=void 0},g=(_,m,n,s)=>(_.addEventListener(m,n,s),()=>_.removeEventListener(m,n,s)),u=B(()=>G(o),_=>{l(),_&&(c=g(_,t,a,r))},{immediate:!0,flush:"post"}),i=()=>{u(),l()};return D()&&T(i),i}function G(o){const t=A(o);return(t==null?void 0:t.$el)??t}const W={"typo-and-paste":'<path d="M10.931 22C9.57512 22 8.37089 21.7948 7.31831 21.3845C6.28357 20.9563 5.47183 20.3498 4.8831 19.5648C4.29437 18.7798 4 17.8432 4 16.7549C4 15.5239 4.31221 14.5427 4.93662 13.8113C5.56103 13.062 6.33709 12.5446 7.26479 12.2592V12.1521C6.46197 11.7596 5.78404 11.2512 5.23099 10.6268C4.69577 9.98451 4.42817 9.11925 4.42817 8.03098C4.42817 6.94272 4.70469 6.02394 5.25775 5.27465C5.82864 4.52535 6.62254 3.96338 7.63944 3.58873C8.65634 3.19624 9.84272 3 11.1986 3C12.5188 3 13.6784 3.20516 14.6775 3.61549C15.6944 4.02582 16.4883 4.61455 17.0592 5.38169C17.63 6.13099 17.9155 7.01408 17.9155 8.03098V8.48591H15.5606V8.19155C15.5427 7.46009 15.3376 6.86244 14.9451 6.39859C14.5704 5.9169 14.0531 5.56901 13.393 5.35493C12.7507 5.123 12.0014 5.00704 11.1451 5.00704C10.5742 5.00704 10.03 5.06948 9.51268 5.19437C8.99531 5.30141 8.53146 5.47981 8.12113 5.72958C7.72864 5.97934 7.41643 6.30939 7.18451 6.71972C6.95258 7.11221 6.83662 7.5939 6.83662 8.16479C6.83662 8.89624 7.01502 9.50282 7.37183 9.98451C7.72864 10.4484 8.19249 10.7962 8.76338 11.0282C9.35211 11.2601 9.98545 11.3761 10.6634 11.3761H12.3225V13.3296H10.7169C10.0033 13.3296 9.31643 13.4188 8.65634 13.5972C7.99624 13.7756 7.46103 14.1056 7.0507 14.5873C6.65822 15.0512 6.46197 15.7202 6.46197 16.5944C6.46197 17.3972 6.6493 18.0484 7.02394 18.5479C7.41643 19.0474 7.96056 19.4131 8.65634 19.6451C9.36995 19.877 10.1906 19.993 11.1183 19.993C12.1174 19.993 12.9469 19.8681 13.607 19.6183C14.2671 19.3685 14.7577 18.985 15.0789 18.4676C15.4 17.9502 15.5606 17.3169 15.5606 16.5676V11.3761H20.1901V13.3563H17.9155V16.4873C17.9155 17.6648 17.6479 18.6639 17.1127 19.4845C16.5953 20.3052 15.8192 20.9296 14.7845 21.3577C13.7498 21.7859 12.4653 22 10.931 22Z"/>'},Z={"typo-and-paste":{icon:"typo-and-paste",label:"Typo & Paste",click(){window.panel.dialog.open({component:"k-typo-and-paste-dialog"})}}},J={"typo-and-paste":{get button(){return{icon:"typo-and-paste",label:"Typo & Paste"}},commands(){return()=>{window.panel.dialog.open({component:"k-typo-and-paste-dialog"})}},get name(){return"typo-and-paste"}}};function Q(o){return o?function(){}:function(t){t.mixin({async mounted(){if(this.$options.name!=="k-header")return;const a=this.$children.find(c=>c.$options.name==="k-button-group");if(!a)return;const r=new t({render:c=>c(S)}).$mount();a.$el.prepend(r.$el),this.$forceUpdate()}})}}const x=window.panel.plugins.viewButtons!==void 0;window.panel.plugin("philippoehrlein/typo-and-paste",{icons:W,components:{"k-typo-and-paste-dialog":z},viewButtons:x?{"typo-and-paste":S}:void 0,textareaButtons:Z,writerMarks:J,use:[function(){N(window,"keydown",o=>{!o.altKey||o.code!=="KeyT"||window.panel.dialog.open({component:"k-typo-and-paste-dialog"})})},Q(x)]})})();
